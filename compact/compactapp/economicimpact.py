from matrixtools import blank_matrix, \
    identity_matrix, \
    short_to_long, \
    long_to_short, \
    short_matrices_compatible, \
    list_to_sublists, \
    list_of_sublists_to_list_of_sums, \
    add_short, \
    subtract_short, \
    multiply_short, \
    divide_short,\
    transpose

from numpy.linalg import inv, det
import numpy

import os
import sqlite3

from matches import naicsmatch, fipsmatch

# Query function copied from queries.py until directory is fixed
def select_column_yield(conn, column_name, fips, own, naics, year):
    '''return column from yield for a given area, industry, and year
        :param: fips_id is the 2 digit fips id
        :param: naics_id is the 3 or 6 digit naics id
        :param: year... well you know the year
    '''
    sql = '''SELECT {} FROM yield
                WHERE fips_id = '{}'
                    AND own_code = '{}'
                    AND naics_id = '{}'
                    AND year = '{}' '''.format(column_name,fips,own,naics,year)
    cur = conn.cursor()
    cur.execute(sql)
    row = cur.fetchone()
    return row


# This matches any given NAICS to its IO sector.
# If a user enters an invalid NAICS, raise a custom ValueError
def match_naics_to_IO(NAICS=111):
    match = naicsmatch
    def loop(NAICS):
        try:
            IO = [pair['IO'] for pair in match if pair['NAICS'] == NAICS][0]
            return IO
        except:
            NAICS = str(NAICS)
            try:
                NAICS = int(NAICS[:len(NAICS) - 1])
                loop(NAICS)
            except:
                raise ValueError('Invalid NAICS entered')
    loop(NAICS)


#This matches a state to a fips:
def fips_match(state):
    for match in fipsmatch:
        if match['state'] == state:
            result = match['fips']
        else:
            pass
    return result


# Return a list of values 0 to 1 for each IO sector (1 through 66)
# TODO:
#   check failed NAICS...
def determine_LQs(geo='Alabama', year=2015, lq_type='wages'):
    base_dir = os.path.dirname(os.path.abspath(__file__))
    database = os.path.join(os.path.dirname(base_dir), 'db.sqlite3')
    conn = sqlite3.connect(database)

    # Get the fips for our state for the query
    fips = fips_match(geo)

    # Create empty lists to add emp and wages to
    local = [{'IO': i+1, 'employees': 0, 'wages': 0} for i in range(0, 66)]
    us = [{'IO': i+1, 'employees': 0, 'wages': 0} for i in range(0, 66)]

    localerrorlist = []
    userrorlist = []

    for io in local:
        for dic in naicsmatch:
            naics = dic['NAICS']
            if dic['IO'] == io['IO']:
                try:
                    io['employees'] += select_column_yield(conn, 'employees', fips, 5, naics, year)[0]
                    io['wages'] += select_column_yield(conn, 'wages', fips, 5, naics, year)[0]
                except:
                    localerrorlist.append(naics)

    for io in us:
        for dic in naicsmatch:
            naics = dic['NAICS']
            if dic['IO'] == io['IO']:
                for i in fipsmatch:
                    try:
                        io['employees'] += select_column_yield(conn, 'employees', i['fips'], 5, naics, year)[0]
                        io['wages'] += select_column_yield(conn, 'wages', i['fips'], 5, naics, year)[0]
                    except:
                        userrorlist.append(naics)

    localtotalemp = 0
    localtotalwages = 0
    ustotalemp = 0
    ustotalwages = 0

    for dict in local:
        localtotalemp += dict['employees']
        localtotalwages += dict['wages']
    for dict in us:
        ustotalemp += dict['employees']
        ustotalwages += dict['wages']

    lqs = [0 for i in range(0,66)]

    if lq_type == 'employees':
        localdenominator = localtotalemp
        usdenominator = ustotalemp
    else:
        localdenominator = localtotalwages
        usdenominator = ustotalwages

    for dict in local:
        lqs[dict['IO']-1] = dict[lq_type] / localdenominator

    for dict in us:
        try:
            lqs[dict['IO']-1] /= dict[lq_type] / usdenominator
        except:
            pass
    lqs.append(1)

    # If an lq is greater than 1, correct it to 1
    # Make sure no lqs are less than 0
    for i in range(len(lqs)):
        if lqs[i] > 1:
            lqs[i] = 1
        elif lqs[i] < 0:
            lqs[i] = 0
        else:
            pass
    print(lqs)
    return [lqs, us, local]


# Return a list of lists of direct requirements for the given year, geo, and type
def determine_direct_requirements(geo='US', year=2015, lq_type='wage'):
    lqoutput = determine_LQs(geo, year, lq_type)
    lqs = lqoutput[0]
    us = lqoutput[1]
    local = lqoutput[2]
    raw_direct_requirements = [
        [71080000000, 25769000000, 0, 2627000000, 0, 4860000000, 2842000000, 784000000, 20000000, 142000000, 2845000000,
         3442000000, 21000000, 469000000, 1095000000, 0, 2000000, 316000000, 31889000000, 232000000, 71000000,
         687000000, 41000000, 11932000000, 19856000000, 2182000000, 25370000000, 15000000, 7000000, 18000000, 167000000,
         305000000, 2562000000, 1849000000, 7767000000, 0, 240000000, 0, 1379000000, 62000000, 0, 545000000, 0,
         7408000000, 281000000, 7314000000, 0, 0, 3806000000, 4689000000, 964000000, 699000000, 2889000000, 0,
         1234000000, 31000000, 470000000, 0, 0, 0, 0, 166000000, 92000000, 10000000, 470000000, 1041000000,
         29581000000],
        [676000000, 6404000000, 0, 2000000, 0, 50000000, 57000000, 193000000, 31000000, 0, 194000000, 260000000,
         1000000, 189000000, 118000000, 11000000, 0, 5000000, 201000000, 72000000, 0, 2000000, 1000000, 441000000,
         1963000000, 115000000, 1549000000, 2000000, 0, 1000000, 7000000, 20000000, 56000000, 17000000, 424000000,
         3000000, 11000000, 555000000, 0, 2000000, 0, 11000000, 1000000, 143000000, 97000000, 225000000, 0, 0, 47000000,
         181000000, 140000000, 47000000, 697000000, 0, 88000000, 15000000, 100000000, 0, 0, 0, 0, 7000000, 1000000, 0,
         0, 261000000, 23260000000, ],
        [0, 0, 14215000000, 18000000, 3631000000, 722000000, 2891000000, 0, 150000000, 1064000000, 1041000000,
         3021000000, 5000000, 16000000, 100000000, 0, 0, 4000000, 0, 0, 0, 10000000, 2000000, 559000000, 2430000000,
         14000000, 1279000000, 6000000, 0, 1000000, 6000000, 17000000, 118000000, 47000000, 238000000, 0, 3456000000,
         1000000, 1000000, 13000000, 0, 94000000, 85000000, 394000000, 143000000, 367000000, 0, 0, 110000000,
         2785000000, 2006000000, 1450000000, 942000000, 4181000000, 169000000, 690000000, 0, 0, 0, 0, 0, 0, 0, 1000000,
         3000000, 51000000, 37713000000, ],
        [34000000, 52000000, 14000000, 11059000000, 1441000000, 1643000000, 1350000000, 46000000, 372000000, 640000000,
         811000000, 5637000000, 26000000, 26000000, 633000000, 14000000, 0, 26000000, 0, 2000000, 0, 148000000, 4000000,
         3361000000, 1682000000, 1263000000, 3537000000, 50000000, 1000000, 4000000, 89000000, 61000000, 3045000000,
         373000000, 1003000000, 9000000, 44000000, 158000000, 194000000, 1000000, 0, 146000000, 12000000, 603000000,
         792000000, 883000000, 0, 0, 71000000, 2345000000, 1098000000, 157000000, 2468000000, 3112000000, 618000000,
         272000000, 0, 0, 0, 0, 0, 2000000, 2000000, 21000000, 35000000, 131000000, 18176000000, ],
        [11000000, 0, 1000000, 119000000, 1355000000, 118000000, 445000000, 53000000, 260000000, 439000000, 285000000,
         3559000000, 174000000, 43000000, 162000000, 0, 0, 9000000, 0, 0, 0, 33000000, 0, 1034000000, 1005000000,
         167000000, 1159000000, 18000000, 0, 1000000, 2000000, 114000000, 88000000, 49000000, 395000000, 26000000,
         11000000, 1000000, 0, 2000000, 0, 198000000, 11000000, 505000000, 674000000, 470000000, 0, 0, 79000000,
         1759000000, 1060000000, 27000000, 2101000000, 1183000000, 706000000, 78000000, 0, 0, 0, 0, 0, 6000000, 8000000,
         59000000, 581000000, 256000000, 35222000000, ],
        [0, 0, 31110000000, 5979000000, 0, 2755000000, 4681000000, 1000000, 64000000, 4000000, 209000000, 2220000000,
         93000000, 22000000, 33000000, 0, 0, 1000000, 0, 0, 11000000, 48000000, 3000000, 9989000000, 1980000000,
         35000000, 3886000000, 6000000, 4000000, 6000000, 283000000, 578000000, 2285000000, 196000000, 588000000,
         93000000, 9729000000, 5719000000, 464000000, 73000000, 0, 276000000, 881000000, 5213000000, 711000000,
         234000000, 0, 0, 2344000000, 1246000000, 3148000000, 933000000, 8198000000, 4000000, 6056000000, 412000000,
         117000000, 0, 0, 0, 0, 230000000, 47000000, 447000000, 1814000000, 600000000, 76905000000, ],
        [1667000000, 0, 0, 12533000000, 0, 2912000000, 175000000, 30131000000, 46768000000, 6476000000, 65050000000,
         28248000000, 7204000000, 31377000000, 9548000000, 10000000, 10284000000, 867000000, 0, 1639000000, 0,
         3145000000, 40000000, 38303000000, 9817000000, 19453000000, 55190000000, 2220000000, 515000000, 1847000000,
         85885000000, 1777000000, 2046000000, 1836000000, 17765000000, 365000000, 321000000, 16000000, 0, 262000000, 0,
         5080000000, 840000000, 6266000000, 3095000000, 107000000, 0, 0, 8990000000, 22940000000, 6272000000,
         2720000000, 40700000000, 3657000000, 7089000000, 2804000000, 27000000, 0, 0, 0, 0, 242000000, 119000000,
         1213000000, 1945000000, 6776000000, 453069000000, ],
        [0, 11248000000, 6000000, 10000000, 0, 1121000000, 181000000, 20024000000, 927000000, 379000000, 2327000000,
         501000000, 671000000, 702000000, 569000000, 21000000, 402000000, 19000000, 16000000, 460000000, 1000000,
         485000000, 10000000, 560000000, 2201000000, 618000000, 6320000000, 52000000, 0, 5000000, 73000000, 381000000,
         779000000, 24000000, 2082000000, 92000000, 7000000, 288000000, 375000000, 6000000, 0, 257000000, 645000000,
         443000000, 43000000, 218000000, 0, 0, 232000000, 502000000, 318000000, 242000000, 2476000000, 4175000000,
         1149000000, 209000000, 0, 0, 0, 0, 0, 69000000, 28000000, 202000000, 644000000, 503000000, 20429000000, ],
        [0, 2000000, 2000000, 11847000000, 0, 2662000000, 242000000, 298000000, 12073000000, 821000000, 2332000000,
         362000000, 888000000, 153000000, 454000000, 0, 2000000, 158000000, 69000000, 305000000, 1000000, 1135000000, 0,
         629000000, 4468000000, 916000000, 4344000000, 72000000, 2000000, 7000000, 15000000, 389000000, 2822000000,
         434000000, 3559000000, 91000000, 9000000, 291000000, 246000000, 6000000, 0, 269000000, 567000000, 805000000,
         126000000, 365000000, 0, 0, 179000000, 894000000, 332000000, 199000000, 2478000000, 4405000000, 1274000000,
         260000000, 0, 0, 0, 0, 0, 55000000, 27000000, 201000000, 554000000, 623000000, 26974000000, ],
        [0, 0, 51000000, 17839000000, 0, 4300000000, 517000000, 369000000, 2706000000, 71504000000, 3964000000,
         2546000000, 1377000000, 1513000000, 484000000, 0, 0, 22000000, 3000000, 0, 0, 1050000000, 0, 1094000000,
         1256000000, 577000000, 15380000000, 44000000, 0, 3000000, 13000000, 436000000, 5034000000, 785000000,
         5775000000, 97000000, 15000000, 35000000, 299000000, 9000000, 0, 234000000, 559000000, 1009000000, 830000000,
         389000000, 0, 0, 168000000, 1117000000, 406000000, 288000000, 3735000000, 4799000000, 2781000000, 376000000, 0,
         0, 0, 0, 0, 79000000, 27000000, 214000000, 741000000, 1250000000, 31681000000, ],
        [0, 0, 3000000, 304000000, 0, 3678000000, 586000000, 241000000, 1529000000, 78677000000, 38906000000,
         5497000000, 4280000000, 2988000000, 1130000000, 26000000, 2000000, 46000000, 0, 0, 0, 2415000000, 2000000,
         818000000, 9103000000, 2409000000, 14423000000, 132000000, 6000000, 19000000, 129000000, 1258000000,
         1019000000, 123000000, 3716000000, 317000000, 11000000, 23000000, 1193000000, 115000000, 0, 1056000000,
         1781000000, 2224000000, 1458000000, 761000000, 0, 0, 1085000000, 4120000000, 1049000000, 2848000000,
         9818000000, 10391000000, 7616000000, 728000000, 0, 0, 0, 0, 0, 175000000, 93000000, 695000000, 1821000000,
         1680000000, 97182000000, ],
        [0, 0, 5000000, 94000000, 0, 1771000000, 350000000, 794000000, 1954000000, 34766000000, 29932000000,
         39537000000, 8370000000, 13825000000, 12265000000, 180000000, 364000000, 2275000000, 0, 1143000000, 0,
         1889000000, 20000000, 1740000000, 4741000000, 8348000000, 24876000000, 1002000000, 19000000, 85000000,
         478000000, 985000000, 510000000, 72000000, 4052000000, 226000000, 22000000, 5000000, 614000000, 47000000, 0,
         870000000, 1587000000, 1566000000, 1155000000, 958000000, 0, 0, 715000000, 3292000000, 1485000000, 2793000000,
         6823000000, 10013000000, 2837000000, 366000000, 0, 0, 0, 0, 0, 136000000, 64000000, 493000000, 1371000000,
         917000000, 94140000000, ],
        [0, 0, 0, 7000000, 0, 607000000, 162000000, 187000000, 344000000, 6180000000, 7035000000, 557000000,
         41599000000, 3296000000, 542000000, 0, 180000000, 2000000, 0, 4000000, 15000000, 654000000, 0, 182000000,
         2756000000, 1529000000, 10919000000, 39000000, 3000000, 8000000, 59000000, 294000000, 109000000, 37000000,
         1256000000, 41000000, 2000000, 0, 249000000, 64000000, 0, 549000000, 322000000, 631000000, 158000000,
         323000000, 0, 0, 2680000000, 1684000000, 3791000000, 1276000000, 6490000000, 6859000000, 2381000000, 125000000,
         0, 0, 0, 0, 0, 20000000, 12000000, 92000000, 220000000, 383000000, 137716000000, ],
        [0, 4000000, 0, 68000000, 0, 585000000, 83000000, 287000000, 1175000000, 19212000000, 7052000000, 2324000000,
         3680000000, 7375000000, 297000000, 0, 2000000, 358000000, 0, 4000000, 0, 867000000, 6000000, 937000000,
         2149000000, 1262000000, 7824000000, 1000000, 5000000, 11000000, 97000000, 121000000, 294000000, 94000000,
         1223000000, 17000000, 7000000, 1000000, 108000000, 6000000, 0, 141000000, 183000000, 269000000, 148000000,
         345000000, 0, 0, 199000000, 656000000, 276000000, 76000000, 1294000000, 2477000000, 558000000, 96000000, 0, 0,
         0, 0, 0, 12000000, 4000000, 37000000, 122000000, 197000000, 34288000000, ],
        [0, 5000000, 3000000, 58000000, 0, 2554000000, 659000000, 2887000000, 6694000000, 38870000000, 38075000000,
         24282000000, 20651000000, 4864000000, 185875000000, 217000000, 431000000, 1652000000, 0, 4251000000,
         1940000000, 2824000000, 5000000, 504000000, 7739000000, 26003000000, 48951000000, 754000000, 35000000,
         112000000, 744000000, 1227000000, 1130000000, 88000000, 7600000000, 221000000, 6000000, 8000000, 1350000000,
         44000000, 0, 698000000, 1144000000, 1575000000, 1257000000, 1091000000, 0, 0, 741000000, 4966000000,
         1609000000, 1006000000, 7831000000, 49602000000, 3744000000, 624000000, 0, 0, 0, 0, 0, 129000000, 62000000,
         476000000, 1314000000, 1625000000, 69332000000, ],
        [0, 0, 1000000, 163000000, 0, 1197000000, 221000000, 198000000, 541000000, 14345000000, 14554000000, 5382000000,
         29205000000, 3628000000, 5182000000, 65776000000, 49000000, 78000000, 0, 1065000000, 0, 992000000, 0,
         488000000, 1997000000, 3597000000, 12420000000, 401000000, 0, 19000000, 58000000, 614000000, 363000000,
         62000000, 2574000000, 94000000, 6000000, 0, 707000000, 116000000, 0, 688000000, 1542000000, 697000000,
         594000000, 309000000, 0, 0, 492000000, 2556000000, 1002000000, 2383000000, 5729000000, 18511000000, 5464000000,
         351000000, 0, 0, 0, 0, 0, 55000000, 29000000, 208000000, 560000000, 680000000, 77438000000, ],
        [0, 37000000, 1000000, 28000000, 0, 438000000, 75000000, 6645000000, 286000000, 3597000000, 3013000000,
         169000000, 960000000, 111000000, 328000000, 0, 5458000000, 11000000, 0, 2448000000, 0, 1080000000, 0,
         226000000, 1527000000, 4255000000, 4626000000, 47000000, 30000000, 63000000, 542000000, 306000000, 290000000,
         23000000, 1356000000, 73000000, 3000000, 232000000, 260000000, 11000000, 0, 450000000, 486000000, 493000000,
         339000000, 238000000, 0, 0, 270000000, 322000000, 235000000, 179000000, 2478000000, 1861000000, 534000000,
         141000000, 0, 0, 0, 0, 0, 35000000, 22000000, 162000000, 390000000, 228000000, 20000000000, ],
        [299000000, 187000000, 1000000, 167000000, 0, 701000000, 138000000, 1007000000, 698000000, 9549000000,
         4593000000, 1303000000, 2508000000, 1067000000, 460000000, 0, 339000000, 6948000000, 12000000, 1878000000,
         62000000, 1896000000, 0, 466000000, 6080000000, 4556000000, 7427000000, 82000000, 32000000, 69000000,
         594000000, 493000000, 252000000, 67000000, 1464000000, 156000000, 7000000, 49000000, 904000000, 35000000, 0,
         539000000, 854000000, 981000000, 617000000, 377000000, 0, 0, 449000000, 2159000000, 1372000000, 503000000,
         6452000000, 9023000000, 1483000000, 226000000, 0, 0, 0, 0, 0, 76000000, 44000000, 338000000, 835000000,
         483000000, 50862000000, ],
        [218084000000, 5870000000, 8000000, 1803000000, 0, 8583000000, 1189000000, 413000000, 5888000000, 4938000000,
         14841000000, 4138000000, 2449000000, 1196000000, 2463000000, 0, 0, 37000000, 175992000000, 122000000, 12000000,
         21992000000, 313000000, 2765000000, 7600000000, 19679000000, 59915000000, 394000000, 57000000, 134000000,
         1077000000, 2042000000, 6259000000, 3387000000, 23997000000, 367000000, 39000000, 172000000, 958000000,
         25000000, 0, 1141000000, 1899000000, 3897000000, 488000000, 1174000000, 0, 0, 783000000, 6321000000,
         1450000000, 1153000000, 13527000000, 40600000000, 4848000000, 1986000000, 0, 0, 0, 0, 0, 267000000, 108000000,
         802000000, 2529000000, 2884000000, 102705000000, ],
        [1518000000, 0, 1000000, 67000000, 0, 639000000, 110000000, 61000000, 149000000, 207000000, 522000000, 34000000,
         428000000, 59000000, 71000000, 0, 0, 157000000, 20000000, 7182000000, 2022000000, 380000000, 0, 100000000,
         9779000000, 343000000, 2954000000, 12000000, 0, 8000000, 79000000, 154000000, 72000000, 17000000, 866000000,
         28000000, 6000000, 34000000, 251000000, 6000000, 0, 156000000, 247000000, 411000000, 42000000, 307000000, 0, 0,
         166000000, 278000000, 186000000, 139000000, 1607000000, 3354000000, 531000000, 203000000, 0, 0, 0, 0, 0,
         29000000, 8000000, 61000000, 243000000, 319000000, 12075000000, ],
        [0, 56000000, 0, 2000000, 0, 200000000, 34000000, 4000000, 0, 0, 156000000, 5000000, 80000000, 12000000,
         5000000, 0, 0, 243000000, 932000000, 4459000000, 3212000000, 73000000, 92000000, 22000000, 364000000, 90000000,
         2369000000, 1000000, 0, 0, 1000000, 82000000, 8000000, 1000000, 470000000, 15000000, 1000000, 0, 148000000,
         5000000, 0, 121000000, 169000000, 242000000, 27000000, 707000000, 0, 0, 139000000, 463000000, 120000000,
         99000000, 1591000000, 2129000000, 2911000000, 55000000, 0, 0, 0, 0, 0, 16000000, 5000000, 33000000, 147000000,
         104000000, 8197000000, ],
        [0, 3685000000, 7000000, 1788000000, 0, 5306000000, 481000000, 5124000000, 327000000, 501000000, 4531000000,
         1437000000, 2382000000, 471000000, 750000000, 0, 3000000, 1000000, 536000000, 2853000000, 0, 38730000000, 0,
         1763000000, 11566000000, 2403000000, 9744000000, 109000000, 7000000, 19000000, 139000000, 475000000,
         2550000000, 160000000, 3312000000, 106000000, 24000000, 212000000, 371000000, 4000000, 0, 341000000, 726000000,
         509000000, 47000000, 242000000, 0, 0, 254000000, 1488000000, 400000000, 273000000, 2896000000, 7439000000,
         1807000000, 425000000, 0, 0, 0, 0, 0, 77000000, 31000000, 234000000, 737000000, 1140000000, 30362000000, ],
        [0, 25000000, 1000000, 0, 0, 812000000, 203000000, 6000000, 2000000, 22000000, 1226000000, 1741000000,
         1061000000, 136000000, 171000000, 0, 0, 9000000, 669000000, 387000000, 3232000000, 6869000000, 1363000000,
         1765000000, 5395000000, 659000000, 2711000000, 26000000, 54000000, 220000000, 1475000000, 597000000, 168000000,
         12000000, 889000000, 147000000, 22000000, 180000000, 527000000, 42000000, 0, 400000000, 406000000, 497000000,
         141000000, 208000000, 0, 0, 296000000, 1087000000, 344000000, 660000000, 2921000000, 3412000000, 3114000000,
         180000000, 90000000, 0, 0, 0, 0, 75000000, 45000000, 505000000, 821000000, 525000000, 26280000000, ],
        [0, 3000000, 265673000000, 948000000, 0, 1466000000, 5819000000, 0, 339000000, 65000000, 132000000, 41000000,
         82000000, 23000000, 37000000, 0, 0, 2000000, 109000000, 17000000, 35000000, 85000000, 2000000, 10605000000,
         4218000000, 98000000, 9297000000, 0, 1000000, 2000000, 68000000, 94000000, 2839000000, 49000000, 4322000000,
         25000000, 8076000000, 74000000, 192000000, 4000000, 0, 193000000, 142000000, 211000000, 44000000, 152000000, 0,
         0, 96000000, 819000000, 274000000, 1045000000, 1279000000, 13331000000, 879000000, 608000000, 2000000, 0, 0, 0,
         0, 25000000, 7000000, 53000000, 235000000, 752000000, 18837000000, ],
        [9777000000, 413000000, 9615000000, 4219000000, 0, 11667000000, 917000000, 347000000, 1852000000, 361000000,
         6484000000, 5347000000, 3539000000, 822000000, 844000000, 0, 0, 638000000, 4269000000, 3000000, 0, 4362000000,
         504000000, 10407000000, 210613000000, 8567000000, 32771000000, 153000000, 78000000, 137000000, 2935000000,
         1208000000, 5287000000, 1401000000, 6747000000, 155000000, 482000000, 42000000, 812000000, 45000000, 0,
         830000000, 766000000, 1519000000, 106000000, 1254000000, 0, 0, 2889000000, 7060000000, 4649000000, 920000000,
         12517000000, 56838000000, 4065000000, 2656000000, 0, 0, 0, 0, 0, 86000000, 43000000, 334000000, 883000000,
         2050000000, 100470000000, ],
        [0, 1779000000, 7000000, 146000000, 0, 3113000000, 373000000, 1264000000, 1776000000, 1829000000, 6682000000,
         2488000000, 2257000000, 989000000, 491000000, 0, 342000000, 60000000, 61000000, 2634000000, 1000000,
         4903000000, 0, 1096000000, 60880000000, 17945000000, 10585000000, 66000000, 9000000, 27000000, 194000000,
         881000000, 1746000000, 65000000, 2893000000, 187000000, 23000000, 141000000, 550000000, 16000000, 0, 544000000,
         836000000, 1712000000, 230000000, 390000000, 0, 0, 429000000, 1541000000, 710000000, 483000000, 5487000000,
         7526000000, 2191000000, 457000000, 1000000, 0, 0, 0, 0, 139000000, 57000000, 482000000, 1173000000, 980000000,
         43651000000, ],
        [1376000000, 0, 28000000, 15000000, 0, 3733000000, 1058000000, 2043000000, 193000000, 1206000000, 1369000000,
         1506000000, 5905000000, 288000000, 3076000000, 9000000, 703000000, 509000000, 1249000000, 646000000, 596000000,
         2787000000, 3732000000, 1978000000, 1438000000, 6053000000, 35904000000, 117000000, 14000000, 56000000,
         488000000, 4437000000, 206000000, 73000000, 3984000000, 424000000, 27000000, 31316000000, 16909000000,
         550000000, 42000000, 11592000000, 2888000000, 12715000000, 1903000000, 17812000000, 0, 0, 44732000000,
         15908000000, 8204000000, 5504000000, 67104000000, 62972000000, 35399000000, 1447000000, 1143000000, 0, 0, 0, 0,
         1074000000, 369000000, 1047000000, 5568000000, 15636000000, 511146000000, ],
        [486000000, 0, 7000000, 1000000, 0, 1238000000, 369000000, 113000000, 191000000, 10000000, 407000000, 288000000,
         612000000, 81000000, 7489000000, 0, 194000000, 114000000, 2000000, 55000000, 391000000, 157000000, 165000000,
         431000000, 118000000, 1336000000, 3475000000, 1238000000, 38000000, 137000000, 2099000000, 257000000, 38000000,
         24000000, 1827000000, 41000000, 6000000, 1985000000, 3054000000, 78000000, 255000000, 2359000000, 1316000000,
         2502000000, 289000000, 3001000000, 0, 0, 14136000000, 1145000000, 553000000, 1226000000, 13954000000,
         705000000, 3851000000, 706000000, 273000000, 0, 0, 0, 0, 277000000, 7000000, 26000000, 770000000, 1861000000,
         110044000000, ],
        [976000000, 341000000, 11000000, 0, 0, 2730000000, 427000000, 477000000, 73000000, 0, 126000000, 121000000,
         287000000, 41000000, 1195000000, 0, 0, 126000000, 2908000000, 109000000, 24000000, 1129000000, 178000000,
         349000000, 93000000, 1683000000, 2051000000, 205000000, 14000000, 49000000, 332000000, 111000000, 105000000,
         53000000, 2815000000, 5000000, 5000000, 988000000, 7487000000, 17000000, 199000000, 838000000, 927000000,
         2407000000, 377000000, 1520000000, 0, 0, 15677000000, 1665000000, 491000000, 436000000, 7876000000, 4721000000,
         3470000000, 572000000, 1678000000, 0, 0, 0, 0, 268000000, 69000000, 102000000, 607000000, 2434000000,
         91045000000, ],
        [239000000, 0, 10000000, 0, 0, 1386000000, 150000000, 134000000, 76000000, 0, 56000000, 60000000, 83000000,
         628000000, 40000000, 0, 0, 3000000, 803000000, 2150000000, 416000000, 313000000, 33000000, 159000000, 12000000,
         283000000, 1665000000, 6000000, 1000000, 5000000, 815000000, 360000000, 34000000, 17000000, 3733000000,
         2000000, 2000000, 2508000000, 11223000000, 24000000, 0, 538000000, 726000000, 765000000, 45000000, 525000000,
         0, 0, 13358000000, 907000000, 383000000, 303000000, 6074000000, 21638000000, 1385000000, 218000000, 0, 0, 0, 0,
         0, 18000000, 0, 4000000, 139000000, 853000000, 90504000000, ],
        [186000000, 2000000, 30000000, 4000000, 0, 4792000000, 1556000000, 920000000, 507000000, 1551000000, 1497000000,
         830000000, 1263000000, 302000000, 3801000000, 0, 742000000, 475000000, 918000000, 1826000000, 692000000,
         1888000000, 4858000000, 1386000000, 756000000, 3908000000, 19902000000, 616000000, 36000000, 139000000,
         2031000000, 1104000000, 121000000, 31000000, 7115000000, 114000000, 18000000, 13361000000, 16923000000,
         348000000, 1000000, 8789000000, 5100000000, 12357000000, 1590000000, 7221000000, 0, 0, 75916000000,
         11081000000, 3305000000, 3840000000, 59327000000, 21299000000, 19076000000, 1455000000, 9212000000, 0, 0, 0,
         2000000, 573000000, 587000000, 374000000, 2891000000, 7527000000, 281236000000, ],
        [0, 0, 0, 0, 0, 130000000, 7000000, 0, 1000000, 0, 500000000, 8000000, 12000000, 7000000, 1000000, 1753000000,
         1000000, 1000000, 88000000, 0, 0, 62000000, 0, 30743000000, 4000000, 8000000, 3095000000, 0, 0, 1000000,
         8000000, 7000000, 147000000, 88000000, 518000000, 1000000, 391000000, 18408000000, 15000000, 11000000,
         14000000, 678000000, 570000000, 794000000, 261000000, 372000000, 0, 0, 2494000000, 8333000000, 1654000000,
         472000000, 2039000000, 565000000, 2689000000, 192000000, 33000000, 0, 0, 0, 0, 20000000, 0, 2000000,
         2040000000, 109000000, 47801000000, ],
        [0, 0, 0, 115000000, 0, 104000000, 913000000, 1312000000, 14000000, 1519000000, 304000000, 106000000, 95000000,
         202000000, 102000000, 1454000000, 0, 2000000, 0, 0, 0, 47000000, 20000000, 6274000000, 242000000, 11000000,
         3433000000, 9000000, 1000000, 2000000, 26000000, 34000000, 281000000, 32000000, 422000000, 401000000, 80000000,
         853000000, 1000000, 56000000, 0, 51000000, 2000000, 1895000000, 2308000000, 26000000, 0, 0, 320000000,
         2917000000, 907000000, 1420000000, 3686000000, 0, 1938000000, 113000000, 30000000, 0, 0, 0, 0, 446000000,
         1000000, 13000000, 17000000, 210000000, 23123000000, ],
        [0, 0, 0, 0, 0, 1338000000, 46000000, 0, 0, 0, 1467000000, 23000000, 3000000, 43000000, 1000000, 1457000000,
         1000000, 0, 48000000, 128000000, 0, 20000000, 0, 5109000000, 8000000, 1000000, 2661000000, 0, 0, 0, 365000000,
         267000000, 25000000, 15000000, 307000000, 0, 65000000, 7167000000, 568000000, 0, 0, 704000000, 0, 174000000,
         840000000, 1755000000, 0, 0, 2946000000, 81000000, 378000000, 26000000, 3688000000, 782000000, 1768000000,
         3371000000, 0, 0, 0, 0, 0, 0, 0, 0, 1000000, 250000000, 7318000000, ],
        [0, 0, 0, 2000000, 0, 648000000, 190000000, 127000000, 45000000, 0, 2713000000, 446000000, 295000000, 251000000,
         9952000000, 1000000, 0, 8000000, 0, 8000000, 0, 223000000, 207000000, 38524000000, 292000000, 1884000000,
         15596000000, 1574000000, 84000000, 291000000, 2166000000, 2918000000, 3533000000, 188000000, 4457000000,
         2000000, 490000000, 36306000000, 5660000000, 10000000, 1000000, 1383000000, 30000000, 3050000000, 821000000,
         9112000000, 0, 0, 5572000000, 11540000000, 112000000, 141000000, 2772000000, 5076000000, 7014000000, 462000000,
         0, 0, 0, 0, 0, 52000000, 1000000, 4000000, 605000000, 1465000000, 90519000000, ],
        [0, 0, 12000000, 0, 0, 947000000, 887000000, 0, 2000000, 0, 282000000, 56000000, 7000000, 64000000, 422000000,
         23000000, 0, 5000000, 0, 0, 0, 77000000, 42000000, 3230000000, 15000000, 39000000, 1313000000, 5000000,
         2000000, 3000000, 66000000, 32000000, 18000000, 9000000, 92000000, 0, 41000000, 405000000, 76000000, 5000000,
         0, 602000000, 44000000, 987000000, 158000000, 4174000000, 0, 0, 454000000, 1772000000, 479000000, 66000000,
         2452000000, 304000000, 1723000000, 1691000000, 0, 0, 0, 0, 0, 4000000, 0, 36000000, 39000000, 496000000,
         19391000000, ],
        [0, 0, 987000000, 0, 0, 58000000, 1219000000, 6000000, 3000000, 0, 1144000000, 185000000, 23000000, 10000000,
         2000000, 0, 0, 1000000, 0, 2000000, 0, 55000000, 6000000, 220000000, 6000000, 178000000, 277000000, 0, 1000000,
         3000000, 17000000, 4000000, 3000000, 4000000, 44000000, 1000000, 47000000, 194000000, 3000000, 0, 0, 44000000,
         23000000, 84000000, 43000000, 86000000, 0, 0, 39000000, 9000000, 63000000, 9000000, 928000000, 0, 188000000,
         55000000, 2000000, 0, 0, 0, 0, 0, 0, 3000000, 4000000, 42000000, 7066000000, ],
        [92000000, 3000000, 0, 3000000, 788000000, 1245000000, 2108000000, 123000000, 51000000, 151000000, 1237000000,
         1448000000, 48000000, 145000000, 1323000000, 1352000000, 6000000, 183000000, 37000000, 48000000, 0, 1670000000,
         83000000, 6460000000, 629000000, 3450000000, 5191000000, 175000000, 1000000, 10000000, 404000000, 2047000000,
         85000000, 35000000, 1772000000, 4000000, 82000000, 34318000000, 4163000000, 25000000, 6000000, 812000000,
         106000000, 689000000, 233000000, 2515000000, 0, 0, 5087000000, 2396000000, 497000000, 244000000, 2320000000,
         2870000000, 7270000000, 972000000, 5000000, 0, 0, 0, 0, 77000000, 4000000, 184000000, 132000000, 1112000000,
         77464000000, ],
        [0, 0, 7000000, 6000000, 0, 1691000000, 178000000, 65000000, 36000000, 0, 335000000, 787000000, 96000000,
         322000000, 658000000, 0, 0, 117000000, 0, 4000000, 0, 238000000, 11000000, 675000000, 125000000, 345000000,
         787000000, 34000000, 1000000, 3000000, 20000000, 141000000, 29000000, 3000000, 193000000, 2000000, 9000000,
         1801000000, 4662000000, 27000000, 0, 799000000, 42000000, 397000000, 76000000, 719000000, 0, 0, 9689000000,
         872000000, 461000000, 310000000, 2849000000, 547000000, 3701000000, 381000000, 0, 0, 0, 0, 0, 59000000,
         1000000, 72000000, 44000000, 1874000000, 42774000000, ],
        [1000000, 0, 2000000, 10000000, 0, 277000000, 41000000, 76000000, 5000000, 17000000, 628000000, 88000000,
         2757000000, 4000000, 325000000, 0, 5000000, 7000000, 13000000, 7000000, 1000000, 1334000000, 9630000000,
         115000000, 253000000, 347000000, 12977000000, 47000000, 1000000, 8000000, 48000000, 1084000000, 31000000,
         4000000, 1228000000, 275000000, 1000000, 2363000000, 507000000, 41233000000, 79000000, 1429000000, 2104000000,
         2107000000, 535000000, 824000000, 0, 0, 3170000000, 3431000000, 1860000000, 3753000000, 11228000000,
         3471000000, 6278000000, 56000000, 0, 0, 0, 0, 0, 219000000, 88000000, 738000000, 1232000000, 931000000,
         114670000000, ],
        [0, 0, 1000000, 15000000, 0, 142000000, 34000000, 116000000, 4000000, 26000000, 31000000, 58000000, 645000000,
         0, 26000000, 0, 0, 3000000, 14000000, 73000000, 10000000, 135000000, 406000000, 27000000, 59000000, 88000000,
         177000000, 4000000, 0, 2000000, 13000000, 292000000, 4000000, 1000000, 93000000, 66000000, 0, 790000000,
         148000000, 47000000, 15802000000, 1130000000, 305000000, 756000000, 173000000, 838000000, 0, 0, 1695000000,
         1654000000, 701000000, 681000000, 4570000000, 321000000, 1169000000, 42000000, 0, 0, 0, 0, 0, 4231000000,
         21000000, 193000000, 334000000, 173000000, 33546000000, ],
        [0, 0, 7000000, 187000000, 0, 3032000000, 2602000000, 597000000, 1441000000, 486000000, 12212000000, 1368000000,
         46099000000, 3803000000, 948000000, 2000000, 113000000, 120000000, 0, 8000000, 1665000000, 500000000,
         406000000, 353000000, 2358000000, 3345000000, 13197000000, 83000000, 1000000, 6000000, 27000000, 1433000000,
         385000000, 46000000, 2086000000, 434000000, 4000000, 208000000, 306000000, 327000000, 44508000000,
         124410000000, 2393000000, 3524000000, 504000000, 912000000, 0, 0, 19765000000, 12788000000, 5252000000,
         3182000000, 54185000000, 2275000000, 11838000000, 260000000, 785000000, 0, 0, 0, 0, 23798000000, 135000000,
         1161000000, 1708000000, 10705000000, 112891000000, ],
        [0, 0, 1000000, 58000000, 0, 850000000, 251000000, 1609000000, 1019000000, 432000000, 1783000000, 577000000,
         5814000000, 431000000, 71000000, 0, 578000000, 157000000, 5000000, 21000000, 5000000, 263000000, 1756000000,
         173000000, 399000000, 423000000, 2702000000, 4000000, 5000000, 18000000, 123000000, 1847000000, 37000000,
         10000000, 769000000, 726000000, 2000000, 3775000000, 760000000, 875000000, 7000000, 4161000000, 4949000000,
         1651000000, 225000000, 750000000, 0, 0, 10447000000, 9009000000, 2102000000, 7538000000, 24433000000,
         2350000000, 8905000000, 103000000, 333000000, 0, 0, 0, 0, 309000000, 226000000, 1941000000, 2938000000,
         2598000000, 56762000000, ],
        [0, 0, 0, 9000000, 0, 873000000, 2053000000, 66000000, 40000000, 0, 87000000, 11000000, 3105000000, 43000000,
         244000000, 0, 0, 97000000, 0, 0, 56000000, 689000000, 298000000, 1009000000, 92000000, 62000000, 1329000000,
         39000000, 7000000, 28000000, 187000000, 4036000000, 29000000, 5000000, 139000000, 1744000000, 13000000,
         713000000, 0, 209000000, 7000000, 3655000000, 3035000000, 68196000000, 54339000000, 9530000000, 0, 0,
         4586000000, 1338000000, 4645000000, 2207000000, 25802000000, 9287000000, 11972000000, 11000000, 43000000, 0, 0,
         0, 0, 1375000000, 545000000, 4622000000, 13602000000, 8739000000, 236307000000, ],
        [0, 0, 2000000, 1000000, 0, 483000000, 244000000, 2000000, 11000000, 0, 28000000, 20000000, 1000000000,
         18000000, 133000000, 0, 0, 23000000, 0, 4000000, 0, 153000000, 2714000000, 97000000, 35000000, 85000000,
         667000000, 26000000, 2000000, 10000000, 62000000, 2258000000, 6000000, 1000000, 416000000, 625000000, 1000000,
         4896000000, 763000000, 505000000, 6000000, 9104000000, 19048000000, 21506000000, 42665000000, 11036000000,
         3259000000, 0, 17136000000, 4113000000, 5965000000, 6488000000, 29581000000, 16134000000, 11000000000,
         242000000, 10000000, 0, 0, 0, 0, 476000000, 193000000, 1661000000, 2485000000, 2028000000, 228887000000, ],
        [0, 0, 1000000, 0, 0, 342000000, 69000000, 41000000, 30000000, 6000000, 131000000, 49000000, 157000000,
         75000000, 105000000, 0, 0, 55000000, 0, 13000000, 0, 410000000, 3593000000, 34000000, 80000000, 1210000000,
         736000000, 35000000, 3000000, 14000000, 90000000, 1355000000, 122000000, 1000000, 319000000, 939000000, 0,
         1461000000, 219000000, 155000000, 0, 4131000000, 1594000000, 10083000000, 4137000000, 295752000000, 4078000000,
         0, 7730000000, 2595000000, 8855000000, 2358000000, 18769000000, 3238000000, 12674000000, 624000000, 0, 0, 0, 0,
         0, 443000000, 206000000, 1685000000, 6300000000, 1483000000, 247826000000, ],
        [0, 0, 0, 0, 0, 4000000, 5000000, 0, 0, 0, 5000000, 0, 224000000, 0, 0, 0, 0, 0, 0, 0, 0, 8000000, 0, 6000000,
         1000000, 1000000, 72000000, 0, 0, 0, 0, 137000000, 0, 0, 5000000, 40000000, 0, 0, 0, 7000000, 0, 289000000,
         234000000, 1425000000, 64615000000, 3128000000, 1699000000, 0, 867000000, 19000000, 897000000, 187000000,
         2346000000, 148000000, 165000000, 0, 0, 0, 0, 0, 0, 52000000, 12000000, 108000000, 429000000, 60000000,
         1134000000, ],
        [51000000, 0, 0, 354000000, 0, 1000000, 69359000000, 3095000000, 756000000, 57000000, 1351000000, 678000000,
         89000000, 473000000, 0, 0, 4043000000, 18000000, 0, 76000000, 0, 101000000, 0, 355000000, 390000000, 466000000,
         1711000000, 31000000, 204000000, 425000000, 4941000000, 92000000, 79000000, 47000000, 648000000, 67000000,
         1000000, 0, 3000000, 3000000, 0, 50000000, 3000000, 28109000000, 47000000, 10097000000, 0, 0, 35834000000,
         35000000, 1536000000, 465000000, 1821000000, 130000000, 8546000000, 220000000, 0, 0, 0, 0, 0, 11000000,
         10000000, 85000000, 102000000, 110000000, 17561000000, ],
        [1000000, 0, 24000000, 3526000000, 0, 81872000000, 64998000000, 1322000000, 31000000, 2249000000, 459000000,
         1594000000, 133000000, 273000000, 183000000, 0, 44000000, 85000000, 0, 28000000, 0, 234000000, 19000000,
         1534000000, 5922000000, 606000000, 1780000000, 249000000, 41000000, 146000000, 760000000, 2377000000,
         955000000, 143000000, 621000000, 894000000, 20000000, 0, 121000000, 215000000, 25000000, 17319000000,
         1131000000, 18164000000, 2447000000, 14237000000, 0, 0, 128914000000, 4591000000, 6598000000, 4977000000,
         24520000000, 4306000000, 182074000000, 12431000000, 0, 0, 0, 0, 0, 1519000000, 271000000, 2367000000,
         12968000000, 14543000000, 84715000000, ],
        [0, 0, 47000000, 416000000, 0, 883000000, 211000000, 1598000000, 442000000, 1247000000, 1796000000, 1017000000,
         427000000, 621000000, 1199000000, 1000000, 319000000, 120000000, 0, 198000000, 463000000, 567000000, 264000000,
         990000000, 396000000, 1702000000, 9823000000, 183000000, 5000000, 24000000, 121000000, 918000000, 69000000,
         27000000, 599000000, 283000000, 13000000, 2447000000, 390000000, 229000000, 2000000, 3004000000, 1165000000,
         16933000000, 1355000000, 5028000000, 0, 0, 9847000000, 6123000000, 6025000000, 9159000000, 21773000000,
         3342000000, 20739000000, 901000000, 0, 0, 0, 0, 0, 213000000, 64000000, 724000000, 2190000000, 7965000000,
         34493000000, ],
        [1000000, 0, 2000000, 1000000, 0, 214000000, 51000000, 5000000, 10000000, 0, 60000000, 40000000, 832000000,
         402000000, 1000000, 0, 34000000, 16000000, 0, 0, 0, 262000000, 601000000, 56000000, 71000000, 65000000,
         485000000, 0, 2000000, 7000000, 54000000, 1378000000, 50000000, 1000000, 169000000, 611000000, 1000000,
         1263000000, 242000000, 581000000, 7000000, 5188000000, 1984000000, 3425000000, 1405000000, 5128000000, 0, 0,
         11915000000, 2371000000, 3096000000, 3197000000, 9912000000, 6174000000, 9430000000, 87000000, 0, 0, 0, 0, 0,
         675000000, 224000000, 1465000000, 4217000000, 1063000000, 123254000000, ],
        [1000000, 0, 2000000, 0, 0, 426000000, 23000000, 7000000, 34000000, 5000000, 581000000, 480000000, 3902000000,
         551000000, 18000000, 0, 5000000, 28000000, 0, 0, 0, 177000000, 134000000, 174000000, 61000000, 237000000,
         1150000000, 2000000, 1000000, 4000000, 25000000, 1615000000, 21000000, 4000000, 167000000, 577000000, 2000000,
         423000000, 84000000, 350000000, 8000000, 3123000000, 1005000000, 2539000000, 417000000, 950000000, 0, 0,
         9058000000, 4354000000, 2803000000, 2868000000, 15970000000, 3222000000, 20589000000, 88000000, 52000000, 0, 0,
         0, 0, 312000000, 202000000, 1782000000, 3425000000, 1527000000, 234436000000, ],
        [527000000, 160000000, 34000000, 1023000000, 41000000, 2900000000, 554000000, 632000000, 3322000000, 2709000000,
         4622000000, 2635000000, 9800000000, 4557000000, 2800000000, 2408000000, 340000000, 2281000000, 1057000000,
         309000000, 41000000, 3618000000, 5271000000, 1097000000, 12983000000, 4660000000, 11074000000, 220000000,
         21000000, 84000000, 574000000, 6247000000, 832000000, 3574000000, 3512000000, 2612000000, 25000000, 8877000000,
         1255000000, 3724000000, 1453000000, 10798000000, 7216000000, 14705000000, 3502000000, 9577000000, 0, 0,
         48069000000, 13880000000, 17569000000, 10785000000, 143030000000, 15261000000, 48568000000, 1724000000,
         105000000, 257000000, 0, 0, 0, 3458000000, 709000000, 5224000000, 16719000000, 10818000000, 551986000000, ],
        [19000000, 11000000, 80000000, 71000000, 3000000, 4435000000, 754000000, 6000000, 102000000, 59000000,
         1021000000, 382000000, 7431000000, 162000000, 754000000, 204000000, 13000000, 28000000, 123000000, 9000000,
         12000000, 579000000, 1004000000, 1162000000, 3556000000, 235000000, 2750000000, 0, 0, 0, 0, 639000000,
         52000000, 124000000, 546000000, 191000000, 15000000, 129000000, 11000000, 1828000000, 245000000, 8909000000,
         8644000000, 13823000000, 7559000000, 2009000000, 4000000, 0, 22120000000, 30490000000, 15039000000,
         22368000000, 75874000000, 10000000, 13242000000, 980000000, 0, 0, 0, 0, 0, 3823000000, 1221000000, 845000000,
         6313000000, 9174000000, 303155000000, ],
        [959000000, 1000000, 17000000, 148000000, 0, 2113000000, 447000000, 723000000, 810000000, 349000000, 2343000000,
         5295000000, 4207000000, 2081000000, 4237000000, 23000000, 11000000, 1471000000, 1000000, 129000000, 369000000,
         2809000000, 2394000000, 5248000000, 5497000000, 2033000000, 7689000000, 512000000, 49000000, 186000000,
         792000000, 5867000000, 398000000, 125000000, 1532000000, 2133000000, 78000000, 3895000000, 1426000000,
         1440000000, 46000000, 11343000000, 10390000000, 7573000000, 2636000000, 9482000000, 0, 0, 19999000000,
         7656000000, 6140000000, 8613000000, 41435000000, 26451000000, 37895000000, 1789000000, 355000000, 52000000, 0,
         0, 0, 2176000000, 908000000, 5112000000, 12312000000, 11751000000, 371168000000, ],
        [0, 0, 15000000, 52000000, 0, 537000000, 35000000, 38000000, 83000000, 944000000, 2088000000, 3978000000,
         1107000000, 666000000, 1665000000, 14000000, 0, 611000000, 0, 57000000, 134000000, 301000000, 27000000,
         1456000000, 1563000000, 324000000, 2240000000, 28000000, 1000000, 5000000, 30000000, 531000000, 71000000,
         35000000, 406000000, 135000000, 18000000, 600000000, 87000000, 6000000, 0, 415000000, 454000000, 306000000,
         68000000, 1295000000, 0, 0, 1965000000, 1667000000, 321000000, 138000000, 2047000000, 2168000000, 4189000000,
         9476000000, 0, 0, 0, 0, 0, 77000000, 43000000, 528000000, 735000000, 1822000000, 26986000000, ],
        [215000000, 81000000, 8000000, 113000000, 0, 11843000000, 465000000, 108000000, 176000000, 108000000, 357000000,
         2736000000, 864000000, 653000000, 1026000000, 0, 1000000, 462000000, 8211000000, 32000000, 40000000, 390000000,
         868000000, 755000000, 840000000, 1026000000, 3025000000, 0, 4000000, 235000000, 423000000, 1555000000,
         75000000, 197000000, 640000000, 599000000, 10000000, 619000000, 104000000, 450000000, 364000000, 3022000000,
         1035000000, 2541000000, 591000000, 1255000000, 0, 0, 39755000000, 4507000000, 629000000, 1706000000,
         9588000000, 2813000000, 5598000000, 972000000, 3124000000, 0, 0, 0, 0, 890000000, 211000000, 1167000000,
         2172000000, 3691000000, 179986000000, ],
        [3000000, 0, 21000000, 0, 0, 2240000000, 461000000, 305000000, 1526000000, 188000000, 365000000, 546000000,
         2778000000, 24000000, 315000000, 0, 219000000, 21942000000, 13000000, 44000000, 163000000, 1602000000,
         1543000000, 699000000, 29668000000, 6305000000, 17581000000, 0, 13000000, 54000000, 415000000, 2802000000,
         410000000, 132000000, 1640000000, 1162000000, 13000000, 2657000000, 615000000, 682000000, 28000000, 7932000000,
         1186000000, 8021000000, 2391000000, 33119000000, 0, 0, 61008000000, 8408000000, 5929000000, 3557000000,
         34998000000, 28346000000, 33643000000, 2036000000, 15000000, 10284000000, 0, 0, 0, 583000000, 396000000,
         2339000000, 10320000000, 7878000000, 495592000000, ],
        [59000000, 286000000, 66000000, 68000000, 0, 6312000000, 896000000, 238000000, 1523000000, 72000000, 607000000,
         576000000, 443000000, 342000000, 484000000, 0, 48000000, 20707000000, 8951000000, 688000000, 192000000,
         2140000000, 1732000000, 3112000000, 21121000000, 3644000000, 15259000000, 0, 8000000, 34000000, 269000000,
         752000000, 318000000, 170000000, 1757000000, 1080000000, 44000000, 3446000000, 869000000, 663000000, 9000000,
         6406000000, 2980000000, 2779000000, 16760000000, 49310000000, 0, 0, 35388000000, 12845000000, 14788000000,
         8142000000, 38039000000, 10799000000, 37085000000, 2330000000, 239000000, 13592000000, 1903000000, 0, 0,
         606000000, 26000000, 226000000, 12129000000, 22439000000, 365829000000, ],
        [40000000, 179000000, 25000000, 31000000, 0, 2158000000, 405000000, 7000000, 222000000, 23000000, 33000000,
         175000000, 233000000, 528000000, 88000000, 0, 2000000, 1994000000, 5704000000, 1028000000, 0, 760000000,
         148000000, 926000000, 2763000000, 1433000000, 3079000000, 0, 1000000, 8000000, 104000000, 518000000, 67000000,
         21000000, 528000000, 470000000, 12000000, 523000000, 147000000, 69000000, 957000000, 1434000000, 234000000,
         2437000000, 877000000, 3544000000, 0, 0, 29283000000, 1285000000, 1289000000, 1047000000, 8039000000,
         3698000000, 6898000000, 1035000000, 0, 51000000, 0, 0, 0, 189000000, 68000000, 333000000, 1299000000,
         2438000000, 123598000000, ],
        [2000000, 0, 12000000, 110000000, 0, 922000000, 323000000, 599000000, 229000000, 211000000, 1154000000,
         98000000, 255000000, 217000000, 800000000, 0, 107000000, 1031000000, 4079000000, 336000000, 595000000,
         382000000, 661000000, 461000000, 395000000, 763000000, 1916000000, 0, 2000000, 6000000, 51000000, 438000000,
         78000000, 23000000, 526000000, 95000000, 6000000, 822000000, 184000000, 201000000, 476000000, 1481000000,
         262000000, 827000000, 2553000000, 2250000000, 0, 0, 18311000000, 838000000, 796000000, 677000000, 5186000000,
         2429000000, 3367000000, 512000000, 0, 2000000, 0, 0, 0, 204000000, 56000000, 255000000, 1620000000, 986000000,
         100908000000, ],
        [0, 0, 8000000, 156000000, 0, 625000000, 112000000, 15000000, 24000000, 40000000, 63000000, 20000000, 35000000,
         33000000, 240000000, 0, 469000000, 90000000, 748000000, 1000000, 80000000, 163000000, 777000000, 196000000,
         270000000, 62000000, 480000000, 2000000, 1000000, 9000000, 766000000, 254000000, 21000000, 10000000, 259000000,
         2071000000, 3000000, 1468000000, 227000000, 29000000, 534000000, 928000000, 409000000, 656000000, 328000000,
         2832000000, 0, 0, 9914000000, 2786000000, 1883000000, 328000000, 8905000000, 2517000000, 4623000000, 159000000,
         1676000000, 57000000, 0, 0, 0, 16773000000, 92000000, 152000000, 336000000, 1502000000, 51890000000, ],
        [287000000, 162000000, 22000000, 535000000, 0, 2026000000, 263000000, 256000000, 230000000, 472000000,
         721000000, 176000000, 195000000, 274000000, 91000000, 4000000, 394000000, 368000000, 3850000000, 419000000,
         45000000, 241000000, 220000000, 784000000, 1428000000, 306000000, 2238000000, 7000000, 2000000, 15000000,
         591000000, 768000000, 73000000, 32000000, 717000000, 94000000, 10000000, 482000000, 112000000, 33000000,
         45000000, 1051000000, 352000000, 2108000000, 246000000, 2264000000, 0, 0, 13281000000, 1700000000, 2011000000,
         675000000, 10294000000, 1978000000, 3331000000, 599000000, 199000000, 2000000, 0, 0, 0, 869000000, 27000000,
         200000000, 447000000, 2293000000, 48368000000, ],
        [51000000, 265000000, 42000000, 59000000, 0, 2753000000, 771000000, 624000000, 85000000, 34000000, 806000000,
         98000000, 259000000, 478000000, 116000000, 0, 4000000, 319000000, 9809000000, 606000000, 31000000, 2232000000,
         784000000, 848000000, 149000000, 157000000, 2893000000, 11000000, 57000000, 239000000, 1742000000, 366000000,
         196000000, 31000000, 670000000, 121000000, 11000000, 191000000, 556000000, 49000000, 136000000, 1743000000,
         332000000, 1476000000, 1597000000, 2585000000, 0, 0, 8154000000, 2567000000, 2627000000, 446000000,
         11994000000, 14908000000, 6422000000, 1213000000, 0, 0, 0, 0, 0, 458000000, 354000000, 537000000, 3580000000,
         2283000000, 76916000000, ],
        [1598000000, 6022000000, 83000000, 316000000, 0, 6189000000, 1065000000, 3243000000, 4769000000, 534000000,
         7472000000, 1824000000, 602000000, 2249000000, 1074000000, 0, 1126000000, 796000000, 76563000000, 455000000,
         268000000, 3338000000, 797000000, 1946000000, 1759000000, 8199000000, 19072000000, 40000000, 39000000,
         497000000, 4237000000, 1501000000, 708000000, 236000000, 4088000000, 504000000, 23000000, 565000000,
         1136000000, 40000000, 765000000, 4867000000, 2298000000, 3460000000, 1235000000, 5841000000, 0, 0, 42357000000,
         9216000000, 2637000000, 1532000000, 24957000000, 51211000000, 8590000000, 2040000000, 0, 0, 0, 0, 0,
         2003000000, 387000000, 1401000000, 4814000000, 7551000000, 260792000000, ],
        [20000000, 54000000, 60000000, 451000000, 0, 4060000000, 3193000000, 251000000, 878000000, 715000000,
         4053000000, 4576000000, 5536000000, 2114000000, 17837000000, 3000000, 145000000, 1436000000, 939000000,
         892000000, 2152000000, 1027000000, 1501000000, 2359000000, 3775000000, 4693000000, 9474000000, 2720000000,
         74000000, 314000000, 1995000000, 1087000000, 167000000, 81000000, 1921000000, 306000000, 31000000, 2131000000,
         546000000, 520000000, 486000000, 5369000000, 2879000000, 6578000000, 21820000000, 3586000000, 0, 0,
         55451000000, 4565000000, 2936000000, 2043000000, 21195000000, 6720000000, 11729000000, 1303000000, 2515000000,
         40000000, 0, 0, 0, 1174000000, 100000000, 791000000, 2212000000, 7280000000, 286003000000, ],
        [71922000000, 6010000000, 0, 457000000, 0, 265522000000, 0, 4283000000, 10811000000, 1250000000, 18156000000,
         11798000000, 79474000000, 40769000000, 235058000000, 18329000000, 45584000000, 97074000000, 563197000000,
         27869000000, 166040000000, 27007000000, 3660000000, 179166000000, 325238000000, 31848000000, 457247000000,
         159366000000, 198264000000, 207312000000, 742955000000, 92655000000, 8274000000, 18478000000, 95122000000,
         38578000000, 2295000000, 11415000000, 711000000, 76270000000, 37015000000, 347328000000, 31818000000,
         258788000000, 160361000000, 342981000000, 158774000000, 1918078000000, 3541000000, 87618000000, 101809000000,
         0, 69165000000, 0, 56031000000, 17344000000, 344343000000, 950316000000, 969235000000, 226339000000,
         178863000000, 77229000000, 175764000000, 129382000000, 666101000000, 595818000000, 0, ],

    ]
    direct_requirements = multiply_short(list_to_sublists(lqs, 67), raw_direct_requirements)
    return [direct_requirements, us, local]


# TODO:
#   first round purchases
def impact(direct_requirements, impact_input):
    industry_totals = [
        392452000000,
        54279000000,
        255415000000,
        117387000000,
        76959000000,
        401824000000,
        1352559000000,
        96698000000,
        114125000000,
        227789000000,
        375001000000,
        389847000000,
        387008000000,
        121595000000,
        678046000000,
        339932000000,
        75721000000,
        167181000000,
        945386000000,
        55003000000,
        32321000000,
        182920000000,
        87838000000,
        498794000000,
        828832000000,
        225517000000,
        1554260000000,
        276295000000,
        230751000000,
        229596000000,
        904093000000,
        188627000000,
        80789000000,
        60164000000,
        333910000000,
        58079000000,
        33206000000,
        226341000000,
        93708000000,
        326396000000,
        154128000000,
        845903000000,
        223270000000,
        755414000000,
        490797000000,
        890115000000,
        141348000000,
        1919236000000,
        1045908000000,
        354199000000,
        321656000000,
        353161000000,
        1288004000000,
        630749000000,
        811145000000,
        92945000000,
        328979000000,
        992969000000,
        802401000000,
        232044000000,
        179235000000,
        169331000000, 147612000000, 243394000000, 723476000000, 663262000000,
        12283684000000
    ]
    direct_requirements = direct_requirements[0]
    us = direct_requirements[1]
    local = direct_requirements[2]
    type_1_A = subtract_short(identity_matrix(67, 67), divide_short(direct_requirements, list_to_sublists(industry_totals, 67)))
    type_1_B = subtract_short(identity_matrix(67, 67), divide_short(direct_requirements, list_to_sublists(industry_totals, 67)))
    del type_1_B[:1]
    for i in type_1_B:
        del i[:1]
    direct_and_indirect = inv(numpy.array(type_1_B)).tolist()
    direct_indirect_and_induced = inv(numpy.array(type_1_A)).tolist()
    print(direct_and_indirect)
    print(direct_indirect_and_induced)

    # determine first round purchases
    # horizontal sum of first round purchases

    # mult sum by direct_and_indirect

    # mult sum by direct_indirect_and_induced

    # indirect reve = horizontal sum of direct_and_indirect

    # induced reve = horizontal sum of direct_indirect_and_induced - pos direct_and_indirect


# Takes a complex user input and translates it to run through the impact model
def complex_impact(user_input=['Alabama', 2015, [111, 0, 0, 0], 'wages']):
    IO = match_naics_to_IO(user_input[2][0])
    final_user_input = [IO, [user_input[1], user_input[2], user_input[3]]]
    direct_requirements = determine_direct_requirements(user_input[0], user_input[1], user_input[3])
    return impact(direct_requirements=direct_requirements, impact_input=final_user_input)


# Takes a simple input (geo, year, sector) and translates it to run through the impact model
# TODO:
#   based on emp, wages for selected sector, estimate revenue
def simple_impact(user_input=['US', 2015, 1]):
    # pull emp, wages for that sector
    # revenue = industry output * LQ
    # run model with those as user inputs
    impact()
    pass


complex_impact()